<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>Fiche de le√ßon Maths 5e ¬∑ Togo ¬∑ Programme officiel complet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-dark: #0b4d3a;
            --primary: #1b6e54;
            --primary-light: #d0f0e4;
            --accent: #f3b33d;
            --bg-light: #f0f8f5;
            --text: #1b4637;
            --white: #ffffff;
            --shadow: 0 10px 20px -8px rgba(0,40,20,0.25);
        }

        body {
            font-family: 'Inter', 'Segoe UI', Roboto, system-ui, sans-serif;
            background: var(--bg-light);
            color: var(--text);
            line-height: 1.5;
            padding: 1rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* BANDEAU RESPONSIVE */
        .bandeau {
            background: linear-gradient(148deg, var(--primary-dark), var(--primary));
            color: white;
            border-radius: clamp(20px, 5vw, 40px);
            padding: clamp(1.2rem, 4vw, 2rem) clamp(1.5rem, 5vw, 2.8rem);
            margin-bottom: clamp(1.5rem, 4vw, 2.8rem);
            box-shadow: var(--shadow);
            width: 100%;
        }

        .bandeau h1 {
            font-size: clamp(1.1rem, 5vw, 1.9rem);
            font-weight: 600;
            line-height: 1.3;
            word-break: break-word;
        }

        .bandeau h2 {
            font-size: clamp(0.95rem, 4vw, 1.3rem);
            font-weight: 400;
            margin-top: 0.5rem;
        }

        .badge-prog {
            background: var(--accent);
            color: var(--primary-dark);
            font-weight: 800;
            padding: 0.4rem clamp(1rem, 3vw, 2.2rem);
            border-radius: 60px;
            display: inline-block;
            margin-top: 1rem;
            font-size: clamp(0.7rem, 3vw, 1rem);
            box-shadow: 0 4px 8px #b57f1a;
            white-space: normal;
            text-align: center;
        }

        /* CARTE G√âN√âRATEUR */
        .card-outil {
            background: var(--white);
            border-radius: clamp(20px, 5vw, 40px);
            padding: clamp(1.2rem, 4vw, 2.4rem) clamp(1.2rem, 4vw, 3rem);
            margin-bottom: clamp(1.8rem, 5vw, 2.8rem);
            border: 2px solid #c3e3d6;
            box-shadow: var(--shadow);
            width: 100%;
        }

        .card-outil h3 {
            font-size: clamp(1.3rem, 5vw, 2rem);
            color: var(--primary);
            border-bottom: 4px solid #c4ecd9;
            padding-bottom: 0.8rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            flex-wrap: wrap;
            word-break: break-word;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: flex-end;
        }

        .form-group {
            flex: 1 1 200px;
            min-width: 160px;
        }

        .form-group label {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
            display: block;
            font-size: clamp(0.85rem, 3vw, 1rem);
        }

        .form-group select, .form-group input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid #c6e2d7;
            border-radius: 50px;
            font-size: clamp(0.9rem, 3vw, 1rem);
            background: #f9fffd;
            transition: 0.2s;
        }

        .form-group select:focus, .form-group input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(27,110,84,0.2);
        }

        .btn-generer {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.9rem 1.5rem;
            border-radius: 60px;
            font-weight: 700;
            font-size: clamp(1.1rem, 4vw, 1.5rem);
            width: 100%;
            margin-top: 1.5rem;
            cursor: pointer;
            transition: 0.2s;
            box-shadow: 0 15px 25px -10px var(--primary);
            white-space: normal;
            line-height: 1.3;
        }

        .btn-generer:hover {
            background: #0f543f;
            transform: translateY(-2px);
        }

        /* FICHE G√âN√âR√âE */
        .fiche-finale {
            background: var(--white);
            border-radius: clamp(25px, 6vw, 60px);
            padding: clamp(1.2rem, 4vw, 3rem) clamp(1.2rem, 4vw, 3.5rem);
            border: 4px solid #a5d7c4;
            margin-top: 2rem;
            box-shadow: var(--shadow);
            width: 100%;
            overflow-x: hidden;
        }

        .hidden {
            display: none !important;
        }

        .fiche-header {
            text-align: center;
            border-bottom: 3px dashed var(--primary);
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }

        .fiche-header h2 {
            font-size: clamp(1.6rem, 6vw, 2.6rem);
            color: var(--primary);
            font-weight: 700;
            word-break: break-word;
        }

        /* sections guide */
        .section-guide {
            background: #f6fdfa;
            border-radius: clamp(18px, 4vw, 40px);
            padding: clamp(1rem, 3vw, 1.8rem) clamp(1.2rem, 4vw, 2.5rem);
            margin-bottom: 1.8rem;
            border-left: clamp(8px, 2vw, 16px) solid var(--primary);
            box-shadow: 0 6px 12px #c1ddd1;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .section-guide h4 {
            font-size: clamp(1.1rem, 4vw, 1.5rem);
            color: #1a5b45;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .badge-consigne {
            background: #fef7e5;
            border-left: clamp(4px, 1.5vw, 8px) solid var(--accent);
            padding: clamp(0.8rem, 2vw, 1.2rem) clamp(1rem, 3vw, 2rem);
            border-radius: 30px;
            font-size: clamp(0.9rem, 3vw, 1.05rem);
            margin: 1rem 0;
            box-shadow: 0 3px 8px #d9e6df;
            word-break: break-word;
        }

        .bullet-list {
            margin-left: 1.2rem;
            line-height: 1.6;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            padding-right: 0.5rem;
        }

        .bullet-list li {
            margin-bottom: 0.4rem;
            word-break: break-word;
        }

        /* tableau responsive */
        .table-cap {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 8px 16px #c4ddd1;
            margin-top: 1rem;
            font-size: clamp(0.8rem, 2.5vw, 0.95rem);
        }

        .table-cap th {
            background: var(--primary);
            color: white;
            font-weight: 600;
            padding: 10px 8px;
            text-align: left;
        }

        .table-cap td {
            border: 1px solid #b7dbc9;
            padding: 10px 8px;
            vertical-align: top;
            word-break: break-word;
        }

        /* actions */
        .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin-top: 2rem;
            justify-content: center;
        }

        .btn-print {
            background: white;
            border: 2px solid var(--primary);
            border-radius: 60px;
            padding: 0.6rem 1.2rem;
            font-weight: 700;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            cursor: pointer;
            transition: 0.2s;
            min-width: 120px;
            flex: 1 0 auto;
            max-width: 200px;
            white-space: nowrap;
        }

        .btn-print:hover {
            background: #e2f3eb;
        }

        @media (max-width: 480px) {
            body { padding: 0.5rem; }
            .btn-print { white-space: normal; min-width: unset; flex-basis: 100%; }
            .form-group { flex-basis: 100%; }
        }

        @media print {
            .no-print, .card-outil, .actions { display: none !important; }
            .fiche-finale { border: none; box-shadow: none; padding: 1.2cm; }
            .section-guide { break-inside: avoid; }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- BANDEAU OFFICIEL 5√®me -->
    <div class="bandeau no-print">
        <h1>üáπüá¨ MINIST√àRE DES ENSEIGNEMENTS PRIMAIRE ET SECONDAIRE</h1>
        <h2>R√âPUBLIQUE TOGOLAISE ‚Äì Travail-Libert√©-Patrie ‚Äì PROGRAMME 5e (PAREC 2018-2019)</h2>
        <div class="badge-prog">MATH√âMATIQUES 5√®me ‚Äì GUIDE D'EX√âCUTION INT√âGRAL</div>
        <p style="margin-top:1rem; font-size:clamp(0.9rem,3vw,1.2rem);">Prisme ¬∑ Cylindre ¬∑ Distance ¬∑ Angles ¬∑ Triangles ¬∑ Cercle ¬∑ Polygones ¬∑ Sym√©trie ¬∑ Rep√©rage ¬∑ Arithm√©tique ¬∑ Fractions ¬∑ Relatifs ¬∑ Puissances ¬∑ √âquations ¬∑ Proportionnalit√©</p>
    </div>

    <!-- G√âN√âRATEUR -->
    <div class="card-outil no-print">
        <h3>üìò G√âN√âRATEUR DE FICHE ‚Äì PROGRAMME 5√®me TOGO</h3>
        <div class="form-row">
            <div class="form-group">
                <label>üìå Le√ßon</label>
                <select id="leconSelect">
                    <option value="">-- Choisir une le√ßon --</option>
                    <optgroup label="‚öôÔ∏è Configurations espace">
                        <option value="prisme-droit">Prisme droit</option>
                        <option value="cylindre-droit">Cylindre droit</option>
                    </optgroup>
                    <optgroup label="üìê Configurations plan">
                        <option value="distance-segments">Distance et segments</option>
                        <option value="angles-5e">Angles (compl√©mentaires, suppl√©mentaires, oppos√©s)</option>
                        <option value="triangles-5e">Triangles (somme des angles)</option>
                        <option value="cercle-5e">Cercle circonscrit</option>
                        <option value="polygones">Polygones (parall√©logrammes, trap√®ze, sym√©trie)</option>
                    </optgroup>
                    <optgroup label="üîÑ Applications plan">
                        <option value="symetrie-5e">Figures sym√©triques (droite/point) ‚Äì approfondissement</option>
                    </optgroup>
                    <optgroup label="üìä Outils vectoriels / rep√©rage">
                        <option value="reperage">Rep√©rage sur droite et quadrillage</option>
                    </optgroup>
                    <optgroup label="üßÆ Calcul num√©rique">
                        <option value="division-euclidienne">Division euclidienne</option>
                        <option value="nombres-premiers">Nombres premiers ‚Äì PPCM ‚Äì PGCD</option>
                        <option value="fractions-5e">Fractions (irr√©ductible, op√©rations)</option>
                        <option value="relatifs-5e">Nombres d√©cimaux relatifs (somme, diff√©rence, multiplication)</option>
                        <option value="puissances">Puissances (exposant naturel)</option>
                    </optgroup>
                    <optgroup label="üìù Calcul litt√©ral / √©quations">
                        <option value="equations">Notion d'√©quation (x+a=b, ax=b)</option>
                    </optgroup>
                    <optgroup label="üìà Organisation donn√©es">
                        <option value="proportionnalite-5e">Proportionnalit√© ‚Äì pourcentage ‚Äì √©chelle</option>
                    </optgroup>
                </select>
            </div>
            <div class="form-group">
                <label>‚è±Ô∏è Dur√©e</label>
                <input type="text" id="dureeField" value="6 heures" placeholder="ex: 8h">
            </div>
            <div class="form-group">
                <label>üìÖ Date</label>
                <input type="date" id="dateField">
            </div>
        </div>
        <button class="btn-generer" id="btnGenerer">‚ú® G√âN√âRER LA FICHE (contenus ¬∑ strat√©gies ¬∑ consignes ¬∑ √©valuation)</button>
    </div>

    <!-- FICHE G√âN√âR√âE -->
    <div class="fiche-finale hidden" id="ficheGeneree">
        <div id="contenuFiche"></div>
        <div class="actions no-print">
            <button class="btn-print" onclick="window.print()">üñ®Ô∏è Imprimer</button>
            <button class="btn-print" onclick="alert('Imprimer ‚Üí Enregistrer en PDF')">üìÑ PDF</button>
            <button class="btn-print" onclick="exportWord()">üìù Word</button>
            <button class="btn-print" onclick="resetFiche()">üîÑ Nouvelle</button>
        </div>
        <div style="margin-top:1.5rem; background:#fdf3da; padding:0.8rem 1.5rem; border-radius:60px; font-size:clamp(0.8rem,2.5vw,0.95rem); text-align:center;" class="no-print">
            ‚ö° Fiche conforme au programme officiel de 5√®me ‚Äì Guide d'ex√©cution int√©gr√©.
        </div>
    </div>
</div>

<script>
(function() {
    // ==================== BASE DE DONN√âES COMPL√àTE CLASSE DE 5√®me ====================
    const lecons = {
        // --- PRISME DROIT ---
        'prisme-droit': {
            theme: 'Configurations de l\'espace',
            titre: 'Prisme droit',
            contenusSynth: [
                'Prisme droit : d√©finitions, vocabulaire (faces, ar√™tes, sommets, bases, surface lat√©rale)',
                'Patron d‚Äôun prisme droit',
                'Aire lat√©rale, aire de base, aire totale, volume (base triangulaire ou rectangulaire)'
            ],
            strategies: [
                'Travail individuel ou en petits groupes : observation de prismes droits r√©els',
                'D√©couverte des diff√©rentes parties : faces (forme, nombre), ar√™tes, sommets, surface lat√©rale, bases',
                'D√©faire le solide pour d√©couvrir le patron, puis construction individuelle'
            ],
            consignes: [
                'Mettre la classe en situation d‚Äôobservation r√©elle de prismes droits (mat√©riel individuel/collectif)',
                'Faire distinguer et nommer les diff√©rentes parties du solide',
                'D√©faire le solide et faire d√©couvrir le patron obtenu ; pr√©senter √©ventuellement d‚Äôautres formes de patron',
                'Veiller √† ce que chaque apprenant r√©alise personnellement le solide √† partir d‚Äôun patron'
            ],
            evaluation: [
                'Reconnaissance du prisme droit dans un groupe de solides',
                'D√©signation par leurs noms des diff√©rentes parties',
                'Construction du patron et r√©alisation du solide',
                'Calcul des grandeurs (aire lat√©rale, totale, volume) par application des formules'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre/Identifier un solide', contenu: 'Prisme droit : d√©finitions, vocabulaire, caract√©ristiques' },
                { capacite: 'D√©crire un solide', contenu: 'Vocabulaire : faces, ar√™tes, sommets, bases, surface lat√©rale' },
                { capacite: 'Construire le patron', contenu: 'Patron d‚Äôun prisme droit' },
                { capacite: 'R√©aliser le solide √† partir du patron', contenu: 'Prisme droit et patron' },
                { capacite: 'Calculer des grandeurs', contenu: 'Aire lat√©rale, aire de base, aire totale, volume d‚Äôun prisme droit √† base triangulaire ou rectangulaire' }
            ],
            prerequis: ['Notions de base en g√©om√©trie (cube, pav√© droit)', 'Utilisation des instruments'],
            materiel: ['Mod√®les de prismes droits', 'Papier cartonn√©, ciseaux, colle', 'R√®gle, √©querre, compas']
        },
        // --- CYLINDRE DROIT ---
        'cylindre-droit': {
            theme: 'Configurations de l\'espace',
            titre: 'Cylindre droit',
            contenusSynth: [
                'Cylindre droit : d√©finitions, vocabulaire (bases, surface lat√©rale, g√©n√©ratrice)',
                'Patron d‚Äôun cylindre de r√©volution',
                'Aire lat√©rale, aire totale, volume d‚Äôun cylindre'
            ],
            strategies: [
                'Travail individuel ou en petits groupes : observation de cylindres r√©els',
                'D√©couverte des diff√©rentes parties : bases circulaires, surface lat√©rale, g√©n√©ratrices',
                'D√©faire un cylindre pour d√©couvrir le patron (rectangle + deux cercles)',
                'Construction individuelle √† partir du patron'
            ],
            consignes: [
                'Pr√©senter des objets cylindriques (bo√Æte de conserve, rouleau)',
                'Faire distinguer les bases et la surface lat√©rale',
                'Montrer le patron en d√©roulant la surface lat√©rale',
                'Veiller √† la pr√©cision du trac√© des cercles et du rectangle'
            ],
            evaluation: [
                'Reconnaissance du cylindre droit dans un groupe de solides',
                'D√©signation des bases, de la surface lat√©rale',
                'Construction correcte du patron et r√©alisation du solide',
                'Calcul de l‚Äôaire lat√©rale, totale et du volume'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre/Identifier un solide', contenu: 'Cylindre droit : d√©finitions, vocabulaire, caract√©ristiques' },
                { capacite: 'D√©crire un solide', contenu: 'Vocabulaire : bases circulaires, surface lat√©rale, g√©n√©ratrice' },
                { capacite: 'Construire le patron', contenu: 'Patron d‚Äôun cylindre de r√©volution' },
                { capacite: 'R√©aliser le solide √† partir du patron', contenu: 'Cylindre et patron' },
                { capacite: 'Calculer des grandeurs', contenu: 'Aire lat√©rale, aire totale, volume d‚Äôun cylindre' }
            ],
            prerequis: ['Cercle, p√©rim√®tre, aire du disque', 'Notions de pav√© droit'],
            materiel: ['Objets cylindriques', 'Papier cartonn√©, compas, ciseaux', 'R√®gle']
        },
        // --- DISTANCE ET SEGMENTS (5e) ---
        'distance-segments': {
            theme: 'Configurations du plan',
            titre: 'Distance et segments',
            contenusSynth: [
                'Distance de deux points, in√©galit√© triangulaire',
                'Caract√©risation d‚Äôun segment, de la m√©diatrice',
                'R√©gionnement du plan par la m√©diatrice'
            ],
            strategies: [
                'Observation et manipulation en petits groupes',
                'M√©thode d√©monstrative ; faire faire',
                'Construction de points v√©rifiant MA = MB, MA < MB, MA > MB'
            ],
            consignes: [
                'Renforcer les notions de 6e (segment, milieu, m√©diatrice)',
                'Faire d√©couvrir que tout point √©quidistant des extr√©mit√©s d‚Äôun segment appartient √† la m√©diatrice (r√©ciproque)',
                'Faire construire des points avec des conditions de distance'
            ],
            evaluation: [
                'Mesure et comparaison de longueurs, distance de deux points',
                'Construction de la m√©diatrice (r√®gle et compas)',
                'Appartenance d‚Äôun point √† une r√©gion d√©limit√©e par la m√©diatrice'
            ],
            capacitesDetails: [
                { capacite: 'Mesurer des grandeurs', contenu: 'Distance de deux points, in√©galit√© triangulaire' },
                { capacite: 'Caract√©riser une configuration', contenu: 'Segment, m√©diatrice d‚Äôun segment' },
                { capacite: 'Construire', contenu: 'M√©diatrice (r√®gle et compas), r√©gionnement du plan par la m√©diatrice' },
                { capacite: 'Justifier', contenu: 'Point milieu, appartenance √† la m√©diatrice, propri√©t√©s' }
            ],
            prerequis: ['Segments, milieu, m√©diatrice (6e)'],
            materiel: ['R√®gle gradu√©e, compas, √©querre']
        },
        // --- ANGLES (5e) ---
        'angles-5e': {
            theme: 'Configurations du plan',
            titre: 'Angles ‚Äì compl√©mentaires, suppl√©mentaires, oppos√©s par le sommet',
            contenusSynth: [
                'Angles compl√©mentaires, suppl√©mentaires, oppos√©s par le sommet',
                '√âgalit√© angulaire'
            ],
            strategies: [
                'Observation et manipulation en petits groupes',
                'M√©thode d√©monstrative ; faire mesurer, calculer'
            ],
            consignes: [
                'Renforcer les notions d‚Äôangles vues en 6e',
                'Faire utiliser le vocabulaire appropri√©',
                'Faire mobiliser les connaissances pour calculer des mesures'
            ],
            evaluation: [
                'Identification d‚Äôangles compl√©mentaires, suppl√©mentaires, oppos√©s',
                'Calcul de mesures d‚Äôangles',
                'Justification de la nature de deux angles'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre/Identifier', contenu: 'Angles compl√©mentaires, suppl√©mentaires, oppos√©s par le sommet' },
                { capacite: 'Comparer/Calculer', contenu: 'Mesures d‚Äôangles, √©galit√© angulaire' },
                { capacite: 'Construire', contenu: 'Angles, angles particuliers' },
                { capacite: 'Justifier', contenu: '√âgalit√© angulaire, nature de deux angles' }
            ],
            prerequis: ['Angles (6e)', 'Utilisation du rapporteur'],
            materiel: ['Rapporteurs, r√®gles, √©querres']
        },
        // --- TRIANGLES (5e) : somme des angles, caract√©risation ---
        'triangles-5e': {
            theme: 'Configurations du plan',
            titre: 'Triangles ‚Äì somme des angles, caract√©risation',
            contenusSynth: [
                'Triangles particuliers (isoc√®le, √©quilat√©ral, rectangle) ‚Äì caract√©risation par les angles',
                'Somme des angles d‚Äôun triangle (180¬∞)',
                'Droites particuli√®res : hauteur, m√©diatrice, bissectrice, m√©diane'
            ],
            strategies: [
                'Observation et manipulation en petits groupes',
                'Faire mesurer les angles de divers triangles pour d√©couvrir la somme de 180¬∞',
                'Construction de triangles avec contraintes'
            ],
            consignes: [
                'Renforcer les notions de triangles d√©j√† install√©es en 6e',
                'Faire mesurer les trois angles et constater la somme constante',
                'Utiliser la somme des angles pour calculer des mesures inconnues'
            ],
            evaluation: [
                'Identification de triangles particuliers',
                'Calcul de mesures d‚Äôangles dans un triangle',
                'Construction de triangles connaissant des angles et c√¥t√©s',
                'Justification de la nature d‚Äôun triangle ou d‚Äôune droite'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre/Identifier', contenu: 'Triangles particuliers (isoc√®le, √©quilat√©ral, rectangle), droites particuli√®res' },
                { capacite: 'Caract√©riser', contenu: 'Triangle isoc√®le, √©quilat√©ral, rectangle (angles)' },
                { capacite: 'Construire/Reproduire', contenu: 'Triangles (mesures de c√¥t√©s et angles), droites particuli√®res' },
                { capacite: 'Calculer', contenu: 'Somme des angles d‚Äôun triangle, √©galit√© angulaire' },
                { capacite: 'Justifier', contenu: '√âgalit√© angulaire, nature d‚Äôun triangle, nature d‚Äôune droite (hauteur, m√©diatrice, bissectrice, m√©diane)' }
            ],
            prerequis: ['Angles, triangles (6e)'],
            materiel: ['Rapporteurs, r√®gles, compas, √©querres']
        },
        // --- CERCLE (5e) : cercle circonscrit ---
        'cercle-5e': {
            theme: 'Configurations du plan',
            titre: 'Cercle ‚Äì cercle circonscrit √† un triangle',
            contenusSynth: [
                'Cercle, cercle circonscrit √† un triangle (notamment triangle rectangle)',
                'R√©gionnement du plan : int√©rieur, ext√©rieur d‚Äôun cercle'
            ],
            strategies: [
                'Observation et manipulation en petits groupes',
                'Faire d√©couvrir le point de concours des m√©diatrices comme centre du cercle circonscrit',
                'Construction de cercles circonscrits'
            ],
            consignes: [
                'Renforcer les notions de cercle vues en 6e',
                'Faire construire les m√©diatrices d‚Äôun triangle pour trouver le centre du cercle circonscrit'
            ],
            evaluation: [
                'Identification du cercle circonscrit √† un triangle',
                'Construction du cercle circonscrit (m√©diatrices)',
                'Appartenance d‚Äôun point √† l‚Äôint√©rieur/ext√©rieur d‚Äôun cercle'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre/Identifier', contenu: 'Cercles, cercle circonscrit √† un triangle (rectangle)' },
                { capacite: 'Construire/Reproduire', contenu: 'Cercles, cercle circonscrit √† un triangle, r√©gionnement int√©rieur/ext√©rieur' },
                { capacite: 'Justifier', contenu: 'Appartenance d‚Äôun point √† un cercle, √† l‚Äôint√©rieur/ext√©rieur (caract√©risation)' }
            ],
            prerequis: ['Cercle (6e)', 'M√©diatrices'],
            materiel: ['Compas, r√®gle, √©querre']
        },
        // --- POLYGONES (5e) ---
        'polygones': {
            theme: 'Configurations du plan',
            titre: 'Polygones ‚Äì parall√©logrammes particuliers, trap√®ze, sym√©trie',
            contenusSynth: [
                'Notion de polygone (triangle, quadrilat√®re)',
                'Parall√©logrammes particuliers : losange, rectangle, carr√© ; trap√®ze',
                '√âl√©ments de sym√©trie (axe, centre) dans triangles particuliers (isoc√®le, √©quilat√©ral) et parall√©logrammes particuliers'
            ],
            strategies: [
                'Observation et manipulation en petits groupes',
                'D√©couverte par les √©l√®ves des √©l√©ments de sym√©trie des polygones particuliers',
                'Construction de polygones particuliers'
            ],
            consignes: [
                'Renforcer les notions de 6e (parall√©logrammes)',
                'Faire d√©couvrir les axes et centres de sym√©trie des figures',
                'Faire calculer l‚Äôaire d‚Äôun parall√©logramme, d‚Äôun trap√®ze'
            ],
            evaluation: [
                'Identification de polygones particuliers (triangles isoc√®le/√©quilat√©ral, losange, rectangle, carr√©, trap√®ze)',
                'Reconnaissance d‚Äôaxes/centres de sym√©trie',
                'Calcul de l‚Äôaire d‚Äôun parall√©logramme, d‚Äôun trap√®ze',
                'Justification de la nature d‚Äôun polygone'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre/Identifier', contenu: 'Polygones (triangles, quadrilat√®res), triangles particuliers, parall√©logrammes particuliers, trap√®ze' },
                { capacite: 'Caract√©riser', contenu: '√âl√©ments de sym√©trie (axe, centre) des triangles particuliers et parall√©logrammes particuliers' },
                { capacite: 'Construire/Reproduire', contenu: 'Triangles particuliers, parall√©logrammes particuliers' },
                { capacite: 'Calculer', contenu: 'Aire d‚Äôun parall√©logramme, d‚Äôun trap√®ze' },
                { capacite: 'Justifier', contenu: 'Nature d‚Äôun polygone (triangle isoc√®le/√©quilat√©ral, losange, rectangle, carr√©)' }
            ],
            prerequis: ['Parall√©logrammes (6e)', 'Sym√©trie'],
            materiel: ['R√®gle, √©querre, compas, rapporteur']
        },
        // --- SYM√âTRIE (5e) approfondissement ---
        'symetrie-5e': {
            theme: 'Applications du plan',
            titre: 'Figures sym√©triques ‚Äì approfondissement',
            contenusSynth: [
                'Configurations sym√©triques par rapport √† une droite et par rapport √† un point',
                '√âl√©ments de sym√©trie (axe, centre) d‚Äôune configuration',
                'Conservation : alignement, distances, angles, parall√©lisme, perpendicularit√©, milieu'
            ],
            strategies: [
                'Observation et manipulation en petits groupes',
                'Construction de sym√©triques (points, segments, droites, angles, cercles)',
                'Utilisation des propri√©t√©s de conservation'
            ],
            consignes: [
                'Renforcer les notions de sym√©trie vues en 6e',
                'S‚Äôassurer de la ma√Ætrise du programme de construction',
                'Faire justifier en utilisant les propri√©t√©s de conservation'
            ],
            evaluation: [
                'Identification de configurations sym√©triques et d‚Äô√©l√©ments de sym√©trie (axe, centre)',
                'Construction de points/figures sym√©triques',
                'Justification de l‚Äôalignement, √©galit√© de distances, d‚Äôangles, parall√©lisme, perpendicularit√©, milieu'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre des √©l√©ments de sym√©trie', contenu: 'Figures admettant un axe ou un centre de sym√©trie' },
                { capacite: 'Construire', contenu: 'Points sym√©triques (droite/point) ; figures sym√©triques (segments, droites, angles, cercles) ‚Äì programme de construction' },
                { capacite: 'Justifier', contenu: 'Alignement (conservation), √©galit√© de distances, √©galit√© angulaire, parall√©lisme, perpendicularit√©, milieu (propri√©t√©s de conservation)' }
            ],
            prerequis: ['Sym√©trie axiale et centrale (6e)'],
            materiel: ['Papier calque, r√®gle, √©querre, compas']
        },
        // --- REP√âRAGE (droite gradu√©e, quadrillage) ---
        'reperage': {
            theme: 'Outils vectoriels, g√©om√©trie analytique',
            titre: 'Rep√©rage sur une droite et sur un quadrillage',
            contenusSynth: [
                'Droite gradu√©e, abscisse (nombres d√©cimaux relatifs)',
                'Notion de couple, d√©placement sur quadrillage (couple d‚Äôentiers relatifs)',
                'Coordonn√©es d‚Äôun n≈ìud, d‚Äôun point'
            ],
            strategies: [
                'Observation et manipulation en petits groupes',
                'Utilisation de frises chronologiques, de plans quadrill√©s',
                'Codage de d√©placements (couple)'
            ],
            consignes: [
                'Faire visualiser le rangement des d√©cimaux relatifs sur une droite gradu√©e',
                'Faire lire le couple de coordonn√©es d‚Äôun n≈ìud/point',
                'Faire placer un point sur quadrillage connaissant ses coordonn√©es'
            ],
            evaluation: [
                'Construction sur une droite gradu√©e de points connaissant leurs abscisses',
                'Lecture du couple de coordonn√©es d‚Äôun n≈ìud/point',
                'Placement sur quadrillage d‚Äôun point connaissant son couple'
            ],
            capacitesDetails: [
                { capacite: 'Visualiser le rangement des nombres d√©cimaux relatifs', contenu: 'Droite gradu√©e' },
                { capacite: 'Coder un d√©placement', contenu: 'Notion de couple ; d√©placement sur quadrillage : couple d‚Äôentiers relatifs' },
                { capacite: 'Lire le couple de coordonn√©es', contenu: 'Couple de coordonn√©es d‚Äôun n≈ìud, d‚Äôun point' },
                { capacite: 'Placer un point sur un quadrillage', contenu: 'Couple de coordonn√©es d‚Äôun point' }
            ],
            prerequis: ['Nombres relatifs', 'Lecture de tableaux'],
            materiel: ['R√®gle gradu√©e', 'Quadrillages', 'Frise chronologique']
        },
        // --- DIVISION EUCLIDIENNE ---
        'division-euclidienne': {
            theme: 'Calcul num√©rique',
            titre: 'Division euclidienne',
            contenusSynth: [
                'Expressions : a = bq + r (r < b) ; pour a non multiple de b : bq < a < b(q+1)',
                'Vocabulaire : dividende, diviseur, quotient, reste',
                'Encadrement d‚Äôun entier par deux multiples cons√©cutifs'
            ],
            strategies: [
                'Travail individuel ou en petits groupes',
                'Situations de partage, de distribution',
                'Recours aux d√©finitions et √©galit√©s'
            ],
            consignes: [
                'Partir de situations concr√®tes pour donner du sens √† la division euclidienne',
                'Faire traduire les situations par des √©galit√©s',
                'Proposer des encadrements'
            ],
            evaluation: [
                'Reconnaissance de la division euclidienne',
                '√âcriture de l‚Äô√©galit√© a = bq + r',
                'Calcul du quotient et reste',
                'Encadrement par deux multiples cons√©cutifs'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre la division euclidienne', contenu: 'Expressions de la division euclidienne (quotient, reste, diviseur, dividende) : a = bq + r, r < b ; bq < a < b(q+1)' },
                { capacite: 'Lire et √©crire', contenu: 'Traduction d‚Äôune situation en √©criture euclidienne' },
                { capacite: 'Calculer', contenu: 'Quotient et reste ; encadrement par deux multiples cons√©cutifs' },
                { capacite: 'Justifier', contenu: 'Caract√©risation de la division euclidienne' }
            ],
            prerequis: ['Multiples, diviseurs (6e)'],
            materiel: ['Fiches d‚Äôexercices']
        },
        // --- NOMBRES PREMIERS, PPCM, PGCD ---
        'nombres-premiers': {
            theme: 'Calcul num√©rique',
            titre: 'Nombres premiers ‚Äì PPCM ‚Äì PGCD',
            contenusSynth: [
                'D√©finition d‚Äôun nombre premier',
                'Liste des nombres premiers < 100',
                'D√©finition du PPCM, du PGCD',
                'D√©composition en produit de facteurs premiers',
                'D√©termination du PGCD et PPCM (par d√©composition ou divisions successives)'
            ],
            strategies: [
                'Travail individuel ou en petits groupes',
                'Recherche de diviseurs, de multiples',
                'Utilisation des crit√®res de divisibilit√©'
            ],
            consignes: [
                'Partir de situations n√©cessitant le calcul du PGCD ou PPCM',
                'Le PGCD est d√©termin√© en appliquant la d√©finition ou en cherchant le diviseur commun rendant une fraction irr√©ductible',
                'Ne pas enseigner la r√®gle utilisant la d√©composition en facteurs premiers (observation uniquement)',
                'Faire rechercher diverses proc√©dures pour d√©terminer multiples et diviseurs'
            ],
            evaluation: [
                'Reconnaissance de nombres premiers',
                'D√©composition en produit de facteurs premiers',
                'Calcul du PGCD et PPCM de deux nombres',
                'Utilisation du PPCM/PGCD pour r√©soudre un probl√®me'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre un nombre premier', contenu: 'D√©finition, nombres premiers < 100, d√©finition du PPCM et PGCD' },
                { capacite: 'Calculer', contenu: 'D√©composition en produit de facteurs premiers ; d√©termination du PGCD et PPCM (par nombres premiers, divisions successives, crit√®res) ; recherche de multiples/diviseurs' },
                { capacite: 'Justifier', contenu: 'Nombres premiers, PPCM et PGCD de deux entiers' }
            ],
            prerequis: ['Multiples, diviseurs, crit√®res de divisibilit√©'],
            materiel: ['Tableau de nombres']
        },
        // --- FRACTIONS (5e) ---
        'fractions-5e': {
            theme: 'Calcul num√©rique',
            titre: 'Fractions ‚Äì irr√©ductible, op√©rations',
            contenusSynth: [
                'Fraction irr√©ductible, fraction d√©cimale',
                '√âcriture q + r/b (avec r/b < 1)',
                'Simplification, conversion d√©cimal ‚Üî fractionnaire (si possible)',
                'Comparaison de deux fractions',
                'R√©duction au m√™me d√©nominateur (utilisation possible du PPCM)',
                'Somme, diff√©rence (d√©nominateurs diff√©rents), produit de deux fractions',
                'Transformation en fraction irr√©ductible'
            ],
            strategies: [
                'Observation et manipulation de fractions',
                'M√©thode d√©monstrative ; faire faire',
                'Utilisation de situations de partage'
            ],
            consignes: [
                'Partir de situations de partage ou de distribution',
                'Demander de traduire les situations par des √©critures fractionnaires diverses (a/b, q + r/b, irr√©ductible)',
                'Proposer des probl√®mes n√©cessitant op√©rations sur fractions'
            ],
            evaluation: [
                'Reconnaissance de fractions d√©cimales et irr√©ductibles',
                'Traduction de situations en fractions',
                'Simplification, somme, diff√©rence, produit',
                'Comparaison, encadrement par deux d√©cimaux'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre des fractions', contenu: 'Fraction irr√©ductible, fraction d√©cimale' },
                { capacite: 'Lire et √©crire', contenu: '√âcriture q + r/b (r<b) ; simplification ; conversion d√©cimal ‚Üî fractionnaire (si possible)' },
                { capacite: 'Comparer', contenu: 'R√®gles de comparaison, comparaison √† l‚Äôunit√©, encadrement par deux d√©cimaux cons√©cutifs' },
                { capacite: 'Calculer', contenu: 'R√©duction au m√™me d√©nominateur (PPCM possible), somme/diff√©rence, produit de deux fractions, transformation en fraction irr√©ductible' },
                { capacite: 'Justifier', contenu: 'Fraction irr√©ductible, d√©composition des fractions' }
            ],
            prerequis: ['Fractions (6e)', 'Diviseurs, multiples'],
            materiel: ['Mat√©riel de partage', 'Bandelettes fractionn√©es']
        },
        // --- NOMBRES D√âCIMAUX RELATIFS (5e) op√©rations ---
        'relatifs-5e': {
            theme: 'Calcul num√©rique',
            titre: 'Nombres d√©cimaux relatifs ‚Äì addition, soustraction, multiplication',
            contenusSynth: [
                'Ensemble ID, signe, distance √† z√©ro (| |), oppos√©',
                'Rep√©rage sur droite gradu√©e, abscisse',
                'Comparaison, rangement',
                'Addition, soustraction, multiplication de d√©cimaux relatifs'
            ],
            strategies: [
                'Travail individuel ou en petits groupes',
                'Situations de gain/perte, temp√©rature, etc.',
                'Exploitation de frises gradu√©es'
            ],
            consignes: [
                'Renforcer les notions de 6e (nombres relatifs)',
                'Pr√©senter des situations diverses mobilisant des relatifs',
                'Proposer des probl√®mes utilisant les op√©rations'
            ],
            evaluation: [
                'Reconnaissance des nombres d√©cimaux relatifs',
                'Traduction de situations par des relatifs',
                'Rep√©rage sur droite gradu√©e',
                'Calculs de somme, diff√©rence, multiplication',
                'Comparaison et rangement'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre', contenu: 'Ensemble ID des nombres d√©cimaux relatifs' },
                { capacite: 'Lire/√âcrire/Repr√©senter', contenu: 'Signe, distance √† z√©ro, oppos√© ; rep√©rage sur droite gradu√©e ; abscisse' },
                { capacite: 'Comparer', contenu: 'R√®gles de comparaison, rangement croissant/d√©croissant' },
                { capacite: 'Calculer', contenu: 'Addition, soustraction, multiplication de d√©cimaux relatifs' },
                { capacite: 'Justifier', contenu: 'Nombre d√©cimal relatif, abscisse d‚Äôun point' }
            ],
            prerequis: ['Nombres relatifs (6e)', 'Droite gradu√©e'],
            materiel: ['Frise, thermom√®tre', 'R√®gle gradu√©e']
        },
        // --- PUISSANCES (exposant naturel) ---
        'puissances': {
            theme: 'Calcul num√©rique',
            titre: 'Puissances (exposant entier naturel)',
            contenusSynth: [
                'D√©finition : a^n (n entier naturel non nul)',
                'Produit de deux puissances d‚Äôun m√™me nombre',
                'Puissance d‚Äôun produit de deux nombres'
            ],
            strategies: [
                'Travail individuel ou en petits groupes',
                'Situations utilisant des r√©p√©titions (aires, volumes)',
                'Observation de produits particuliers'
            ],
            consignes: [
                'Pr√©senter des situations permettant de mobiliser des puissances',
                'Faire lire et √©crire des puissances',
                'Proposer des calculs simples sur puissances'
            ],
            evaluation: [
                'Reconnaissance de puissances de nombres d√©cimaux √† exposant naturel',
                'Traduction de situations par des puissances',
                'Calcul de produits de puissances, puissance d‚Äôun produit'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre une puissance', contenu: 'D√©finition de la puissance d‚Äôun nombre d√©cimal relatif √† exposant entier naturel non nul' },
                { capacite: 'Lire des puissances', contenu: 'Lecture de a^n' },
                { capacite: '√âcrire des puissances', contenu: '√âcriture de la puissance d‚Äôun nombre d√©cimal relatif √† exposant entier naturel non nul' },
                { capacite: 'Calculer', contenu: 'Produit de deux puissances d‚Äôun m√™me nombre ; puissance d‚Äôun produit de deux nombres d√©cimaux' },
                { capacite: 'Justifier', contenu: 'Puissances d‚Äôun nombre d√©cimal relatif' }
            ],
            prerequis: ['Multiplication', 'Notation'],
            materiel: ['Fiches d‚Äôexercices']
        },
        // --- NOTION D'√âQUATION (x+a=b, ax=b) ---
        'equations': {
            theme: 'Programmes de calcul, Calcul litt√©ral',
            titre: 'Notion d‚Äô√©quation',
            contenusSynth: [
                'Notion d‚Äô√©quation, inconnue, solution',
                '√âquations du type x + a = b (dans ID)',
                '√âquations du type a x = b (dans ID)',
                'Liens avec des programmes de calcul'
            ],
            strategies: [
                'Travail individuel ou en petits groupes',
                'Partir de situations concr√®tes d√©bouchant sur une √©quation',
                'Utiliser des programmes de calcul'
            ],
            consignes: [
                'Proposer des situations simples permettant des mises en √©quation',
                'Demander de traduire une situation par une √©quation',
                'Faire r√©soudre en utilisant les propri√©t√©s des op√©rations sur les relatifs'
            ],
            evaluation: [
                'Identification d‚Äô√©quations des types x+a=b ou ax=b',
                'Traduction d‚Äôune situation concr√®te en √©quation',
                'R√©solution de probl√®mes par mise en √©quation'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre une √©quation', contenu: 'Notion d‚Äô√©quation, inconnue, solution ; √©quations x+a=b, ax=b ; liens avec programmes de calcul' },
                { capacite: 'Lire/√©crire une √©quation', contenu: 'Traduction d‚Äôune situation en √©quation' },
                { capacite: 'Calculer / R√©soudre', contenu: 'Exemples simples de r√©solution d‚Äô√©quations x+a=b ou ax=b ; programmes de calcul' },
                { capacite: 'Justifier', contenu: '√âquations, solutions' }
            ],
            prerequis: ['Op√©rations sur relatifs', 'Programmes de calcul'],
            materiel: ['Fiches de situations']
        },
        // --- PROPORTIONNALIT√â, POURCENTAGE, √âCHELLE (5e) ---
        'proportionnalite-5e': {
            theme: 'Organisation des donn√©es',
            titre: 'Proportionnalit√© ‚Äì pourcentage ‚Äì √©chelle',
            contenusSynth: [
                'Reconna√Ætre une situation de proportionnalit√© (tableau, graphique)',
                'Coefficient de proportionnalit√© (vitesse, masse volumique, d√©bit)',
                'Pourcentage, √©chelle',
                'Repr√©sentation graphique (point par point) d‚Äôun tableau de proportionnalit√©'
            ],
            strategies: [
                'Travail individuel ou en petits groupes',
                'Partir de situations de la vie courante et des sciences',
                'Utiliser des graphiques pour reconna√Ætre la proportionnalit√©'
            ],
            consignes: [
                'Proposer des situations (vie courante, sciences) et demander si elles rel√®vent de la proportionnalit√©',
                'Faire v√©rifier par un tableau ou un graphique',
                'Faire calculer des grandeurs (quatri√®me proportionnelle, pourcentage, √©chelle)',
                'Faire reproduire un dessin √† une √©chelle donn√©e'
            ],
            evaluation: [
                'Identification de situations de proportionnalit√© (tableau, graphique)',
                'Repr√©sentation graphique d‚Äôun tableau de proportionnalit√©',
                'Calcul d‚Äôune quatri√®me proportionnelle, de pourcentages, d‚Äô√©chelle',
                'Agrandissement/r√©duction de figures'
            ],
            capacitesDetails: [
                { capacite: 'Reconna√Ætre une situation de proportionnalit√©', contenu: '√Ä partir d‚Äôun graphique' },
                { capacite: 'Calculer une grandeur', contenu: 'Coefficient de proportionnalit√© (vitesse, masse volumique, d√©bit) ; pourcentage ; √©chelle' },
                { capacite: 'Construire une repr√©sentation graphique', contenu: 'Repr√©sentation graphique (point par point) d‚Äôun tableau de proportionnalit√©' }
            ],
            prerequis: ['Proportionnalit√© (6e)', 'Op√©rations'],
            materiel: ['Tableaux, graphiques', 'Cartes g√©ographiques', 'Instruments de dessin']
        }
    };

    // --- Initialisation et fonctions ---
    const select = document.getElementById('leconSelect');
    const dureeInput = document.getElementById('dureeField');
    const dateInput = document.getElementById('dateField');
    const btn = document.getElementById('btnGenerer');
    const ficheDiv = document.getElementById('ficheGeneree');
    const contenuFiche = document.getElementById('contenuFiche');

    const today = new Date().toISOString().split('T')[0];
    dateInput.value = today;

    select.addEventListener('change', function() {
        if (lecons[this.value]) dureeInput.value = '6 heures'; // valeur par d√©faut
    });

    function generer() {
        const id = select.value;
        if (!id || !lecons[id]) { alert('Veuillez s√©lectionner une le√ßon.'); return; }
        const lec = lecons[id];
        const duree = dureeInput.value || '6 heures';
        const date = dateInput.value ? new Date(dateInput.value).toLocaleDateString('fr-FR') : '√Ä d√©terminer';

        const contenuItems = lec.contenusSynth.map(c => `<li>${c}</li>`).join('');
        const stratItems = lec.strategies.map(s => `<li>${s}</li>`).join('');
        const consignesDiv = lec.consignes.map(c => `<div class="badge-consigne">üì£ ${c}</div>`).join('');
        const evalItems = lec.evaluation.map(e => `<li>${e}</li>`).join('');
        const capRows = lec.capacitesDetails.map(item => 
            `<tr><td style="font-weight:600; width:35%;">${item.capacite}</td><td>${item.contenu}</td></tr>`
        ).join('');

        const html = `
            <div class="fiche-header">
                <h2>${lec.titre}</h2>
                <p style="font-size:clamp(0.9rem,2.5vw,1.15rem);">Th√®me : ${lec.theme} ‚Äî Dur√©e : ${duree} ‚Äî Date : ${date}</p>
            </div>
            <div class="section-guide"><h4>üìã CONTENUS (synth√®se programme)</h4><ul class="bullet-list">${contenuItems}</ul></div>
            <div class="section-guide"><h4>üß† STRAT√âGIES P√âDAGOGIQUES</h4><ul class="bullet-list">${stratItems}</ul></div>
            <div class="section-guide"><h4>üó£Ô∏è CONSIGNES</h4>${consignesDiv}</div>
            <div class="section-guide"><h4>‚úÖ √âVALUATION</h4><ul class="bullet-list">${evalItems}</ul></div>
            <div class="section-guide"><h4>üîé CAPACIT√âS & CONTENUS ASSOCI√âS</h4>
                <table class="table-cap"><tr><th>Capacit√©</th><th>Contenu (programme officiel)</th></tr>${capRows}</table>
            </div>
            <div class="section-guide"><h4>üì¶ PR√âREQUIS & MAT√âRIEL</h4>
                <p><strong>Pr√©requis :</strong> ${lec.prerequis.join(', ')}</p>
                <p><strong>Mat√©riel :</strong> ${lec.materiel.join(' ¬∑ ')}</p>
            </div>
        `;
        contenuFiche.innerHTML = html;
        ficheDiv.classList.remove('hidden');
        ficheDiv.scrollIntoView({ behavior: 'smooth' });
    }

    btn.addEventListener('click', generer);
    document.addEventListener('keydown', (e) => { if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') generer(); });

    window.exportWord = function() {
        if (ficheDiv.classList.contains('hidden')) return alert('G√©n√©rez d‚Äôabord une fiche.');
        const content = contenuFiche.innerHTML;
        const style = '<style>body { font-family: Arial; margin: 2cm; } .section-guide { margin-bottom:20px; } .table-cap { border-collapse: collapse; width:100%; } .table-cap td, .table-cap th { border:1px solid #aaa; padding:8px; } .badge-consigne { background:#fef7e5; padding:10px; border-left:6px solid #f3b33d; }</style>';
        const full = `<!DOCTYPE html><html><head><meta charset="UTF-8">${style}</head><body>${content}</body></html>`;
        const blob = new Blob([full], {type: 'application/msword'});
        const link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = 'Fiche_5e_guide.doc'; link.click();
    };
    window.resetFiche = function() {
        ficheDiv.classList.add('hidden');
        select.value = '';
        dureeInput.value = '6 heures';
        dateInput.value = today;
    };
})();
</script>
</body>
</html>
